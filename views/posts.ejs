<% include partials/header %>

    <link rel="stylesheet" href="/css/posts.css" type="text/css">

    <div id="main">
        <a href="./posts/new">Make a New POST!!!</a>
        <!--<%= typeof err != 'undefined' ? err : '' %> -->
        <div id="grid">
            <% posts.forEach(function (post) { %>
                <% if (post.imgPath != undefined) { %>
                    <div class="post">
                        <h3><%=post.title%></h3>
                        <div class="data" data-test-value='<%= JSON.stringify(post) %>'></div>
                        <img src="..<%= post.imgPath%>">
                        <p><%= post.description.substring(0, 100) %>...</p>
                        <a href="./posts/<%= post._id %>">Read More!</a>
                        <% if (typeof user== 'undefined') { %>
                            <p>ELSE</p>
                            <form action="./login">
                                <button>Like</button>
                            </form>
                        <% } else if (!post.likes.liker.some(function (el) { return el.equals(user._id)})) { %>
                            <p>IF</p>
                                <button>Like</button>
                        <% } else { %>
                            <p>ELSE</p>
                                <button class="liked">Like</button>
                        <% } %>
                    </div>
                <% } %>
            <% }); %>
        </div>
    </div>
    <script type="text/javascript" src="/javascript/posts.js"></script>
<% include partials/footer %>
